<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>MAGIKS: A practical example</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="/home/nimasoft/Downloads/MathJax-2.6-latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MAGIKS
   &#160;<span id="projectnumber">1.1</span>
   </div>
   <div id="projectbrief">Manipulator General Inverse Kinematic Solver</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">A practical example </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This example shows how to use S-PR2 to control the PR2 robot in simulation or real envirionment.</p>
<h3>Launch PyRide</h3>
<p>Before proceeding, make sure that PyRide is installed on your computer. PyRide is required to communicate with ROS in order to send and receive data to/from S-PR2 object into the real robot. If you have installed PyRide, please find the instructions https://github.com/uts-magic-lab/pyride_pr2/blob/master/README.md "here".</p>
<p><b>Note</b> If you are running your project in Gazebo simulation environment, make sure you have installed Gazebo on your computer. Then before launching Pyride, you need to have the Gazebo simulation environment launched and PR2 spawned:</p>
<p>``` roslaunch gazebo_ros empty_world.launch roslaunch pr2_gazebo pr2.launch ```</p>
<p>After the installation, launch PyRide in the ROS environment in which PR2 is working:</p>
<p>``` roslaunch pyride_pr2 pyride.launch ```</p>
<p>You can now connect to the python interface by using this command:</p>
<p>``` telnet host 27005 ```</p>
<p>where <code>host</code> is the robot/machine on which PyRIDE is running. If pyride is running on the same computer as the MAGIKS is installed replace it by <code>localhost</code>.</p>
<p>If everything is running well, you should be in the python console environment.</p>
<h3>Introduce python packages to PyRide</h3>
<p>For the time being, PyRide requires all the packages paths to be added to the <code>sys.path</code> list. Before start, you need to add the path of the installed packages to the list of system packages in pyride python environment. You should do this for all the packages required by magiks: numpy, sympy, pyinterval, matplotlib</p>
<p>Example:</p>
<p>``` import sys</p>
<p>numpy_path = '/usr/lib/python2.7/dist-packages/' sympy_path = '/usr/local/lib/python2.7/dist-packages/' pyinterval_path = '/usr/local/lib/python2.7/dist-packages/pyinterval-1.0b21-py2.7-linux-x86_64.egg/' mtpltlib_path = '/usr/lib/pymodules/python2.7'</p>
<p>sys.path.append(sympy_path) sys.path.append(numpy_path) sys.path.append(pyinterval_path) sys.path.append(mtpltlib_path) ```</p>
<p>These paths might be different in your computer.</p>
<p>Finally add the path to the MAGIKS directory:</p>
<p>``` sys.path.append(&lt;your_magiks_path&gt;) ```</p>
<h3>Create a S-PR2 object:</h3>
<p>To start working with S-PR2, you need to create a <a href="http://uts-magic-lab.github.io/Magiks/classmagiks_1_1specific__geometries_1_1pr2_1_1skilled__pr2_1_1_skilled___p_r2.html">```Skilled_PR2()```</a> object:</p>
<p>``` from <a class="el" href="namespacemagiks_1_1specific__geometries_1_1pr2.html">magiks.specific_geometries.pr2</a> import skilled_pr2 as spr obj = spr.Skilled_PR2() ```</p>
<p>Now you can start to work with the robot.</p>
<h3>Arm Basic Motion Premitives:</h3>
<p>Arm Basic Movement Premitive (ABMP) methods can be used to move the arms towards specific directions. The object has a reference arm on which every arm movement method, is applied. It can be either left or right arm. To check which one is the current reference arm, check boolean property <code>obj.larm_reference</code>. If it is <code>True</code>, left arm, otherwise right arm is the reference arm. You can change the reference arm by setting this property:</p>
<p>To move the right arm <em>10 (cm)</em> backwards:</p>
<p>``` obj.larm_reference = False #set the reference arm to right arm obj.arm_back() ```</p>
<p>The right arm pulls back <em>10 (cm)</em> towards torso maintaining the orientation. The default movement length is <em>10 (cm)</em>. You can set your desired length by setting argument <b>dx</b>: ``` obj.arm_back(dx = 0.15) ```</p>
<p>You can move the arm maintaining its orientation to one of the six basic directions w.r.t. the torso: ``` obj.arm_forward() obj.arm_back() obj.arm_up() obj.arm_down() obj.arm_left() obj.arm_right() ``` In all these movements, the reference for the direction is torso. You can change the reference to the arm gripper (end-effector) by setting boolean argument <b>relative</b> to <code>True</code>. For example, to move the left arm forward <em>12 (cm)</em> towards the gripper pointing direction: ``` obj.larm_reference = True #sets the reference arm to left arm obj.arm_forward(dx = 0.12, relative = True) ```</p>
<p>You can change the arm orientation to one of the six basic orientations w.r.t. the torso: ``` obj.larm_reference = False obj.arm_orient('forward') # default obj.arm_orient('backward') obj.arm_orient('upward') obj.arm_orient('downward') obj.arm_orient('left') obj.arm_orient('right') ```</p>
<p>You can change the motion speed by setting property <code>obj.arm_speed</code> (set to <em>0.05</em> by default)</p>
<h3>Move to a target pose in the task-space</h3>
<p>To move the arm to a specific position and orientation in the task-space, you need to first set a target and then move the arm: ``` pos_l = obj.larm.wrist_position() # Read the left arm position w.r.t. the left arm base ori_l = obj.larm.wrist_orientation() # Read the left arm orientation w.r.t. the torso obj.rarm.set_target(pos_l, ori_l) # Set the left arm pose as a target for the right arm obj.larm_reference = False # Make sure right arm is the reference arm obj.arm_target() # Move the arm to the desired pose ```</p>
<h3>Draw a trajectory</h3>
<p>To draw a trajectory, you should define it. For this example, we will use one of the predefined trajectories in the library. You can create your own trajectory easily by specifying the path points with your desired position, speed and acceleration for each point. Here we pick one pre-defined trajectory from library:</p>
<p>``` from <a class="el" href="namespacemath__tools_1_1geometry.html">math_tools.geometry</a> import shape_trajectories as sht S = sht.S(height = 0.2) ``` To have a three-dimensional plot of the selected trajectory, type: ``` S.plot3d() ```</p>
<p>Now run the trajectory on the arm: ``` obj.arm_orient() # Change the gripper orientation to forward for a better view obj.arm_back(dx = 0.25) # Move back for a better dexterity for the arm obj.arm_trajectory(S) # Run the motion ``` </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun May 8 2016 19:53:35 for MAGIKS by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
